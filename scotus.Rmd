---
title: "Exploring U.S. Supreme Court Decisions"
author: "Ojaswi Malik"
output: github_document
---

## Get the data

```{r, echo = TRUE}
# load useful packages
library(tidyverse)
theme_set(theme_minimal()) 

# load data
scdbv_mod <- read_csv("data/SCDB_2019_01_justiceCentered_Citation.csv", col_types = 
                        cols(
                          docket = col_character()
                        ))

scdbv_leg <- read_csv("data/SCDB_Legacy_05_justiceCentered_Citation.csv", col_types = 
                        cols(
                          docket = col_character(),
                          adminAction = col_double(),
                          adminActionState = col_double(),
                          sctCite = col_character()
                        ))
scdbv_mod
scdbv_leg
```

## Combine the datasets

```{r}
scdbv <- bind_rows(scdbv_mod, scdbv_leg)
```

## Recode variables as you find necessary

```{r}

```

## What percentage of cases in each term are decided by a one-vote margin (i.e. 5-4, 4-3, etc.)

```{r}
cases <- scdbv %>%
  select(caseIssuesId, term, majVotes, minVotes)

unique_cases <- unique(cases)

unique_cases %>%
  group_by(term) %>%
  mutate(total = n(), one_vote = majVotes - minVotes) %>%
  filter(one_vote == 1 ) %>%
  group_by(term, one_vote, total) %>%
  summarise(
    count = n(),
  ) %>%
  ggplot(mapping = aes(x = term, y = count/total )) +
  geom_line() +
  scale_y_continuous(labels=scales::percent) + 
  labs ( title = "Percent of US Supreme court cases decided by 1-vote margin", 
         x = "Term",
         y = "Percent of total cases decided", 
         caption = "Source: The Supreme Court Database")

# 0 not taken in account on x-axis
```

## In each term he served on the Court, in what percentage of cases was Justice Antonin Scalia in the majority?

```{r}
scdbv %>%
  filter( justiceName == "AScalia" ) %>%
  group_by(term) %>%
  summarise(
    percent = mean(majority == 2, na.rm = TRUE) 
  ) %>%
  ggplot(mapping = aes(x = term, y = percent )) +
  geom_line() +
  scale_y_continuous(labels = scales::percent, limits=c(0,NA)) + 
  labs ( title = "Percent of the time Scalia was in the majority", 
         x = "Term",
         y = "Percent of total decisions", 
         caption = "Source: The Supreme Court Database")

```

## Create a graph similar to above that adds a second component which compares the percentage for all cases versus non-unanimous cases (i.e. there was at least one dissenting vote)

```{r}

all_cases <- scdbv %>%
  filter(justiceName == "AScalia" ) %>%
  select(term, minVotes, majority) %>%
  group_by(term) %>%
  summarise(
    percent = mean(majority == 2, na.rm = TRUE)
  ) 

non_unanimous <- scdbv %>%
  filter( justiceName == "AScalia" & minVotes > 0) %>%
  group_by(term) %>%
  summarise(
    percent = mean(majority == 2, na.rm = TRUE) 
  )
  

ggplot( mapping = aes(x = term, y = percent)) +
  geom_line(data = all_cases, aes(color = "All decisions")) +
  geom_line(data = non_unanimous, aes(color = "Non-unanimous decisions")) + 
  scale_y_continuous(labels = scales::percent, limits=c(0,NA)) +
  labs ( title = "Percent of the time Scalia was in the majority", 
         x = "Term",
         y = "Percent of total decisions", 
         caption = "Source: The Supreme Court Database") +
  theme(legend.position="bottom", legend.title = element_blank())



```

## In each term, what percentage of cases were decided in the conservative direction?

```{r}
case <- scdbv %>%
  select(caseIssuesId, term, decisionDirection)

only_unique_cases <- unique(case)

only_unique_cases %>%
  group_by(term) %>%
  mutate(total = n()) %>%
  filter( decisionDirection == 1) %>%
  group_by(term, decisionDirection, total) %>%
  summarise( count = n()) %>%
  ggplot (mapping = aes(x = term, y = count/total)) +
  geom_line() +
  scale_y_continuous(labels=scales::percent) + 
  labs ( title = "U.S. Supreme Court",
         subtitle = "Percent of cases decided in a conservative fashion", 
         x = "Term",
         y = "Percent of total decisions", 
         caption = "Source: The Supreme Court Database")

```

## The Chief Justice is frequently seen as capable of influencing the ideological direction of the Court. Create a graph similar to the one above that also incorporates information on who was the Chief Justice during the term.

```{r}

```

## In each term, how many of the term's published decisions (decided after oral arguments) were announced in a given month?

```{r}


```

## Session info

```{r, echo = TRUE}
devtools::session_info()
```


